<!DOCTYPE html>
<html lang="ta">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Video Bot & Translator</title>
    <style>
        :root {
            --primary: #007bff;
            --success: #28a745;
            --video: #e83e8c;
            --bg: #f4f7f9;
        }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background-color: var(--bg); display: flex; justify-content: center; padding: 20px; }
        .container { background: white; width: 100%; max-width: 700px; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        
        h2 { color: #333; margin-bottom: 20px; }
        input, textarea { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 10px; font-size: 16px; box-sizing: border-box; }
        
        .btn-group { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin: 15px 0; }
        button { padding: 12px; cursor: pointer; border: none; border-radius: 10px; color: white; font-weight: bold; transition: 0.3s; font-size: 14px; }
        
        .btn-translate { background-color: var(--success); }
        .btn-ask { background-color: var(--primary); }
        .btn-video { background-color: var(--video); }
        button:hover { opacity: 0.9; transform: translateY(-2px); }
        button:disabled { background-color: #ccc; cursor: not-allowed; }

        /* à®µà¯€à®Ÿà®¿à®¯à¯‹ à®ªà®•à¯à®¤à®¿ */
        #video-container { display: none; margin-top: 20px; border-radius: 15px; overflow: hidden; border: 3px solid var(--video); background: #000; }
        video { width: 100%; display: block; }

        /* à®…à®µà¯à®Ÿà¯à®ªà¯à®Ÿà¯ à®ªà®¾à®•à¯à®¸à¯ (à®ªà¯†à®°à®¿à®¯ à®‰à®°à¯ˆà®•à®³à¯à®•à¯à®•à®¾à®•) */
        #output-area { margin-top: 20px; text-align: left; }
        .output-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; }
        #response-box { 
            background: #f8f9fa; padding: 20px; border-radius: 10px; border: 1px solid #eee;
            max-height: 400px; overflow-y: auto; white-space: pre-wrap; word-wrap: break-word;
            line-height: 1.6; color: #333; font-size: 16px;
        }
        .copy-btn { background: #6c757d; padding: 5px 12px; font-size: 12px; }
        .status { font-size: 14px; color: #666; font-style: italic; margin-top: 5px; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ¤– AI Ultimate Bot</h2>
    
    <input type="text" id="ngrokUrl" placeholder="Ngrok URL-à® à®‡à®™à¯à®•à¯‡ à®ªà¯‡à®¸à¯à®Ÿà¯ à®šà¯†à®¯à¯à®¯à®µà¯à®®à¯ (e.g. https://xxxx.ngrok-free.app)">
    
    <textarea id="userInput" rows="5" placeholder="à®†à®™à¯à®•à®¿à®²à®¤à¯à®¤à®¿à®²à¯ à®Ÿà¯ˆà®ªà¯ à®šà¯†à®¯à¯à®¯à®µà¯à®®à¯ à®…à®²à¯à®²à®¤à¯ à®•à¯‡à®³à¯à®µà®¿à®•à®³à¯ˆà®•à¯ à®•à¯‡à®Ÿà¯à®•à®µà¯à®®à¯..."></textarea>
    
    <div class="btn-group">
        <button class="btn-translate" id="btn-t" onclick="callApi('translate')">Translate</button>
        <button class="btn-ask" id="btn-a" onclick="callApi('ask')">Ask AI</button>
        <button class="btn-video" id="btn-v" onclick="callApi('ask_video')">Video Bot</button>
    </div>

    <p id="status-text" class="status"></p>

    <div id="video-container">
        <video id="aiVideo" controls>
            <source id="videoSource" src="" type="video/mp4">
            Your browser does not support video.
        </video>
    </div>

    <div id="output-area">
        <div class="output-header">
            <strong>à®ªà®¤à®¿à®²à¯ (Response):</strong>
            <button class="copy-btn" onclick="copyText()">Copy Text</button>
        </div>
        <div id="response-box">à®•à®¾à®¤à¯à®¤à®¿à®°à¯à®•à¯à®•à®¿à®±à®¤à¯...</div>
    </div>
</div>

<script>
    async function callApi(mode) {
        const text = document.getElementById('userInput').value;
        const baseUrl = document.getElementById('ngrokUrl').value;
        const responseBox = document.getElementById('response-box');
        const statusText = document.getElementById('status-text');
        const videoContainer = document.getElementById('video-container');
        const videoPlayer = document.getElementById('aiVideo');

        if (!baseUrl || !text) {
            alert("URL à®®à®±à¯à®±à¯à®®à¯ à®‰à®°à¯ˆà®¯à¯ˆ à®‰à®³à¯à®³à®¿à®Ÿà®µà¯à®®à¯!");
            return;
        }

        // UI-à® à®²à¯‹à®Ÿà®¿à®™à¯ à®¨à®¿à®²à¯ˆà®•à¯à®•à¯ à®®à®¾à®±à¯à®±à¯à®¤à®²à¯
        responseBox.innerText = "à®šà®¿à®¨à¯à®¤à®¿à®•à¯à®•à®¿à®±à®¤à¯... à®¤à®¯à®µà¯à®šà¯†à®¯à¯à®¤à¯ à®•à®¾à®¤à¯à®¤à®¿à®°à¯à®•à¯à®•à®µà¯à®®à¯.";
        statusText.innerText = mode === 'ask_video' ? "à®µà¯€à®Ÿà®¿à®¯à¯‹ à®‰à®°à¯à®µà®¾à®•à¯à®•à®ªà¯à®ªà®Ÿà¯à®•à®¿à®±à®¤à¯ (à®‡à®¤à¯ 1 à®¨à®¿à®®à®¿à®Ÿà®®à¯ à®µà®°à¯ˆ à®†à®•à®²à®¾à®®à¯)..." : "à®ªà®¤à®¿à®²à¯ à®¤à®¯à®¾à®°à®¾à®•à®¿à®±à®¤à¯...";
        setButtonsDisabled(true);

        const cleanUrl = baseUrl.endsWith('/') ? baseUrl.slice(0, -1) : baseUrl;

        try {
            const response = await fetch(`${cleanUrl}/${mode}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text: text })
            });

            const data = await response.json();

            if (data.error) {
                responseBox.innerText = "Error: " + data.error;
            } else {
                responseBox.innerText = data.result;

                // à®µà¯€à®Ÿà®¿à®¯à¯‹ à®®à¯‹à®Ÿà¯ à®à®©à¯à®±à®¾à®²à¯ à®µà¯€à®Ÿà®¿à®¯à¯‹à®µà¯ˆ à®‡à®¯à®•à¯à®•à¯à®¤à®²à¯
                if (mode === 'ask_video' && data.video_url) {
                    videoContainer.style.display = 'block';
                    // à®•à¯‡à®šà¯ (Cache) à®¤à®µà®¿à®°à¯à®•à¯à®• à®¨à¯‡à®°à®¤à¯à®¤à¯ˆ à®‡à®£à¯ˆà®•à¯à®•à®¿à®±à¯‹à®®à¯
                    videoPlayer.src = data.video_url + "?t=" + new Date().getTime();
                    videoPlayer.load();
                    videoPlayer.play();
                } else {
                    videoContainer.style.display = 'none';
                }
            }
            statusText.innerText = "à®®à¯à®Ÿà®¿à®¨à¯à®¤à®¤à¯!";
        } catch (error) {
            responseBox.innerText = "à®šà®°à¯à®µà®°à¯ à®•à®©à¯†à®•à¯à®·à®©à¯ à®¤à¯‹à®²à¯à®µà®¿! URL à®šà®°à®¿à®¯à®¾à®• à®‰à®³à¯à®³à®¤à®¾ à®à®©à®ªà¯ à®ªà®¾à®°à¯à®•à¯à®•à®µà¯à®®à¯.";
            statusText.innerText = "à®¤à¯‹à®²à¯à®µà®¿!";
        } finally {
            setButtonsDisabled(false);
        }
    }

    function setButtonsDisabled(state) {
        document.getElementById('btn-t').disabled = state;
        document.getElementById('btn-a').disabled = state;
        document.getElementById('btn-v').disabled = state;
    }

    function copyText() {
        const text = document.getElementById('response-box').innerText;
        navigator.clipboard.writeText(text).then(() => {
            alert("Text copied!");
        });
    }
</script>

</body>
</html>
